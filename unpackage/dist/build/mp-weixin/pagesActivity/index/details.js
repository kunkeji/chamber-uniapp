(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagesActivity/index/details"],{1083:function(t,i,e){"use strict";var n=e("12af"),o=e.n(n);o.a},"12af":function(t,i,e){},"1ba7":function(t,i,e){"use strict";(function(t,i){var n=e("47a9");e("13b0");n(e("3240"));var o=n(e("99ff"));t.__webpack_require_UNI_MP_PLUGIN__=e,i(o.default)}).call(this,e("3223")["default"],e("df3c")["createPage"])},2612:function(t,i,e){"use strict";(function(t){var n=e("47a9");Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o=n(e("7ca3")),a=n(e("db5e")),c=e("8f59");function r(t,i){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);i&&(n=n.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),e.push.apply(e,n)}return e}var s={components:{carousel:function(){e.e("pages/component/carousel/carousel").then(function(){return resolve(e("0ffb"))}.bind(null,e)).catch(e.oe)}},data:function(){return{loadEnd:!1,activityId:null,activityInfo:{},activityInterval:null,countdown:{day:0,hours:0,minutes:0,seconds:0},showLogin:!1}},computed:function(t){for(var i=1;i<arguments.length;i++){var e=null!=arguments[i]?arguments[i]:{};i%2?r(Object(e),!0).forEach((function(i){(0,o.default)(t,i,e[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):r(Object(e)).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))}))}return t}({},(0,c.mapState)({themeColor:function(t){return t.app.themeColor},iconTime:function(t){return a.default.svgToUrl("time",t.app.themeColor)},iconLocation:function(t){return a.default.svgToUrl("location",t.app.themeColor)},iconNavigation:function(t){return a.default.svgToUrl("navigation",t.app.themeColor)},subscribeId:function(t){return t.app.subscribeNotifyIds.applet_activity_apply},loginImg:function(t){return t.app.loginImg}})),onLoad:function(i){var e=this;this.activityId=i.id,t.showLoading({title:"加载中"}),this.getActivity((function(){e.loadEnd=!0,t.hideLoading()}))},onShareAppMessage:function(){return{title:this.activityInfo.name,path:"/pagesActivity/index/details?id="+this.activityId,imageUrl:this.activityInfo.image_list[0]}},onShareTimeline:function(){return{title:this.activityInfo.name,path:"/pagesActivity/index/details?id="+this.activityId,imageUrl:this.activityInfo.image_list[0]}},onUnload:function(){clearInterval(this.activityInterval)},methods:{getActivity:function(i){var e=this;this.$util.request("activity.details",{id:this.activityId}).then((function(n){1==n.code?2==n.data.activity_auth?e.getMemberState((function(){i&&i(),e.activityInfo=n.data,e.activityInfo.time_frame=e.getTimeFrame(n.data.start_time,n.data.end_time),e.activityInfo.images?e.activityInfo.image_list=e.activityInfo.images.split(","):e.activityInfo.image_list=[],e.getCountdown()})):(i&&i(),e.activityInfo=n.data,e.activityInfo.time_frame=e.getTimeFrame(n.data.start_time,n.data.end_time),e.activityInfo.images?e.activityInfo.image_list=e.activityInfo.images.split(","):e.activityInfo.image_list=[],e.getCountdown()):(i&&i(),t.showToast({title:n.msg,icon:"none"}))})).catch((function(t){401==t?e.showLogin=!0:console.error("获取活动详情 ",t)}))},getMemberState:function(i){var e=this;this.$util.request("member.state").then((function(n){1==n.code?6==n.data.state.state?i():-1==n.data.state.state?t.showModal({title:"系统提示",content:"此页面需成为会员后可查看！",confirmColor:e.themeColor,confirmText:"去加入",success:function(i){i.confirm&&t.navigateTo({url:"/pages/member/apply/index"})}}):t.showModal({title:"系统提示",content:"此页面需成为会员后可查看！",confirmColor:e.themeColor,confirmText:"前往查看",success:function(i){i.confirm&&t.switchTab({url:"/pages/mine/index"})}}):t.showToast({title:n.msg,icon:"none"})})).catch((function(t){console.error("获取会员状态 ",t)}))},getCountdown:function(){var t=this,i=(new Date).getTime();this.countdown=this.$util.getTimeDifference(i,1e3*this.activityInfo.apply_time),0==this.countdown.day&&0==this.countdown.hours&&0==this.countdown.minutes&&0==this.countdown.seconds?(this.activityInfo.activity_state=2,clearInterval(this.activityInterval)):this.activityInterval=setInterval((function(){var i=(new Date).getTime();t.countdown=t.$util.getTimeDifference(i,1e3*t.activityInfo.apply_time),0==t.countdown.day&&0==t.countdown.hours&&0==t.countdown.minutes&&0==t.countdown.seconds&&(t.activityInfo.activity_state=2,clearInterval(t.activityInterval))}),1e3)},getTimeFrame:function(t,i){var e=this.$util.formatDate(t,"object"),n=this.$util.formatDate(i,"object"),o="".concat(e.year,"-").concat(e.month,"-").concat(e.day," ").concat(e.hours,":").concat(e.minutes),a="".concat(n.year,"-").concat(n.month,"-").concat(n.day," ").concat(n.hours,":").concat(n.minutes);return o+"—"+a},toNavigation:function(){this.$util.toPage({mode:7,address:{latitude:this.activityInfo.latitude,longitude:this.activityInfo.longitude,address:this.activityInfo.address}})},onContact:function(){this.$util.toPage({mode:6,phone:this.activityInfo.mobile})},toApplication:function(){var i=this;2==this.activityInfo.apply_status?this.subscribeMessage((function(){i.$util.toPage({mode:1,path:"/pagesActivity/index/order?id="+i.activityId})})):t.showToast({title:"此活动您已报名过,看看其它活动吧!",icon:"none"})},subscribeMessage:function(i){var e=this;t.requestSubscribeMessage({tmplIds:[this.subscribeId],success:function(){i()},fail:function(n){20004==n.errCode?t.showModal({title:"提示",content:"请前往设置打开接受通知",confirmColor:e.themeColor,confirmText:"继续报名",success:function(t){t.confirm&&i()}}):t.showModal({title:"提示",content:"未订阅消息，无法接收到活动通知",confirmColor:e.themeColor,confirmText:"继续报名",success:function(t){t.confirm&&i()}})}})},toLogin:function(){t.navigateTo({url:"/pages/login/index"})},toBack:function(){1==getCurrentPages().length?this.$util.toPage({mode:1,path:"/pages/index/index"}):t.navigateBack()}}};i.default=s}).call(this,e("df3c")["default"])},"99ff":function(t,i,e){"use strict";e.r(i);var n=e("bbab"),o=e("c7dd");for(var a in o)["default"].indexOf(a)<0&&function(t){e.d(i,t,(function(){return o[t]}))}(a);e("1083");var c=e("828b"),r=Object(c["a"])(o["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],void 0);i["default"]=r.exports},bbab:function(t,i,e){"use strict";e.d(i,"b",(function(){return o})),e.d(i,"c",(function(){return a})),e.d(i,"a",(function(){return n}));var n={mpHtml:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/mp-html/components/mp-html/mp-html")]).then(e.bind(null,"6ac6"))}},o=function(){var t=this.$createElement;this._self._c},a=[]},c7dd:function(t,i,e){"use strict";e.r(i);var n=e("2612"),o=e.n(n);for(var a in n)["default"].indexOf(a)<0&&function(t){e.d(i,t,(function(){return n[t]}))}(a);i["default"]=o.a}},[["1ba7","common/runtime","common/vendor"]]]);