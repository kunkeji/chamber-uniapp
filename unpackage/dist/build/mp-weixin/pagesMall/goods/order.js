(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagesMall/goods/order"],{"0bb8":function(t,e,o){"use strict";var n=o("1fbe"),a=o.n(n);a.a},"11c4":function(t,e,o){"use strict";o.r(e);var n=o("6dd2"),a=o("c922");for(var r in a)["default"].indexOf(r)<0&&function(t){o.d(e,t,(function(){return a[t]}))}(r);o("0bb8");var s=o("828b"),i=Object(s["a"])(a["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],void 0);e["default"]=i.exports},"1fbe":function(t,e,o){},"2e40":function(t,e,o){"use strict";(function(t){var n=o("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n(o("7ca3")),r=n(o("db5e")),s=o("8f59");function i(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}var d={components:{store:function(){o.e("pagesMall/component/store/store").then(function(){return resolve(o("65d9"))}.bind(null,o)).catch(o.oe)},addressModal:function(){o.e("pagesMall/component/modal/address").then(function(){return resolve(o("d6b7"))}.bind(null,o)).catch(o.oe)}},data:function(){return{loadEnd:!1,goodsId:null,goodsData:{},addressData:{},freight:0}},computed:function(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?i(Object(o),!0).forEach((function(e){(0,a.default)(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):i(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}({},(0,s.mapState)({themeColor:function(t){return t.app.themeColor},iconMore:function(t){return r.default.svgToUrl("more",t.app.themeColor)}})),onLoad:function(e){var o=this;t.showLoading({title:"加载中"}),this.goodsId=e.id,this.getGoodsDetails((function(){t.hideLoading(),o.loadEnd=!0})),this.getAddress()},methods:{getGoodsDetails:function(e){var o=this;this.$util.request("mall.goodsDetails",{id:this.goodsId}).then((function(n){1==n.code?(o.goodsData=n.data,o.goodsData.images=n.data.image,o.getPostage(e)):(e&&e(),t.showToast({title:n.msg,icon:"none"}))})).catch((function(t){e&&e(),console.error("获取商品详情",t)}))},getAddress:function(){var e=this;this.$util.request("mall.addressList",{is_default:1}).then((function(o){1==o.code?o.data[0]&&(e.addressData=o.data[0]):t.showToast({title:o.msg,icon:"none"})})).catch((function(t){console.error("获取默认地址",t)}))},getPostage:function(e){var o=this;this.$util.request("mall.getPostage",{pay_price:this.goodsData.price}).then((function(n){e&&e(),1==n.code?o.freight=n.data.price:t.showToast({title:n.msg,icon:"none"})})).catch((function(t){e&&e(),console.error("获取运费",t)}))},submitOrder:function(){var e=this;this.addressData&&this.addressData.id?(t.showLoading({title:"提交中",mask:!0}),this.$util.request("mall.createOrder",{goods_id:this.goodsId,address_id:this.addressData.id}).then((function(o){if(t.hideLoading(),1==o.code){var n=parseFloat(Number(e.goodsData.price)+Number(e.freight));e.$util.toPage({mode:2,path:"/pagesMall/order/pay?money="+n+"&id="+o.data.order_id})}else t.showToast({title:o.msg,icon:"none"})})).catch((function(t){console.error("创建订单",t)}))):t.showToast({title:"请选择收货地址",icon:"none"})},chooseAddress:function(){this.$refs.addressModal.open(this.addressData.id)},changeAddress:function(t){this.addressData=t}}};e.default=d}).call(this,o("df3c")["default"])},"6dd2":function(t,e,o){"use strict";o.d(e,"b",(function(){return n})),o.d(e,"c",(function(){return a})),o.d(e,"a",(function(){}));var n=function(){var t=this.$createElement,e=(this._self._c,this.loadEnd?parseFloat(Number(this.goodsData.price)+Number(this.freight)).toFixed(2):null);this.$mp.data=Object.assign({},{$root:{g0:e}})},a=[]},c564:function(t,e,o){"use strict";(function(t,e){var n=o("47a9");o("13b0");n(o("3240"));var a=n(o("11c4"));t.__webpack_require_UNI_MP_PLUGIN__=o,e(a.default)}).call(this,o("3223")["default"],o("df3c")["createPage"])},c922:function(t,e,o){"use strict";o.r(e);var n=o("2e40"),a=o.n(n);for(var r in n)["default"].indexOf(r)<0&&function(t){o.d(e,t,(function(){return n[t]}))}(r);e["default"]=a.a}},[["c564","common/runtime","common/vendor"]]]);