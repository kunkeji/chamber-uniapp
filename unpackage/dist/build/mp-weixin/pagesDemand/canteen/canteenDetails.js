(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagesDemand/canteen/canteenDetails"],{"398b":function(e,t,r){"use strict";(function(e){var n=r("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r("7eb4")),c=n(r("af34")),o=n(r("ee10")),s={data:function(){return{navigationBarTitle:"订单列表",orders:[],refreshInterval:null,loading:!1,page:1,hasMore:!0}},created:function(){this.fetchOrderList(),this.startRefreshInterval()},beforeDestroy:function(){this.stopRefreshInterval()},methods:{fetchOrderList:function(){var t=arguments,r=this;return(0,o.default)(a.default.mark((function n(){var o,s;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(o=t.length>0&&void 0!==t[0]&&t[0],!r.loading){n.next=3;break}return n.abrupt("return");case 3:return r.loading=!0,n.prev=4,o&&(r.page=1,r.hasMore=!0),n.next=8,r.$util.request("main.Shop.getOrderList",{page:r.page});case 8:s=n.sent,r.orders=o?s:[].concat((0,c.default)(r.orders),(0,c.default)(s)),r.hasMore=s.length>0,r.page++,n.next=17;break;case 14:n.prev=14,n.t0=n["catch"](4),e.showToast({title:"获取订单列表失败",icon:"none"});case 17:return n.prev=17,r.loading=!1,n.finish(17);case 20:case"end":return n.stop()}}),n,null,[[4,14,17,20]])})))()},getOrderStatusText:function(e){switch(e){case"-1":return"未支付";case"1":return"已支付";case"2":return"已接单";case"3":return"准备好了";case"4":return"正在配送";case"5":return"已完成";case"0":return"已取消";default:return e}},getOrderTypeText:function(e){switch(e){case"1":return"到店吃";case"2":return"自取";case"3":return"外卖";default:return e}},formatDate:function(e){var t=new Date(e);return"".concat(t.getFullYear(),"-").concat(String(t.getMonth()+1).padStart(2,"0"),"-").concat(String(t.getDate()).padStart(2,"0")," ").concat(String(t.getHours()).padStart(2,"0"),":").concat(String(t.getMinutes()).padStart(2,"0"))},startRefreshInterval:function(){var e=this;this.refreshInterval=setInterval((function(){e.fetchOrderList()}),6e4)},stopRefreshInterval:function(){this.refreshInterval&&clearInterval(this.refreshInterval)},orderDetails:function(t){e.navigateTo({url:"/pagesDemand/canteen/orderDetails?id="+t})},onRefresh:function(){var t=this;return(0,o.default)(a.default.mark((function r(){return a.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.fetchOrderList(!0);case 2:e.stopPullDownRefresh();case 3:case"end":return r.stop()}}),r)})))()},onLoadMore:function(){this.hasMore&&!this.loading&&this.fetchOrderList()},goToPayment:function(t){var r=t.order_details.map((function(e){return{goods_name:e.name,quantity:e.quantity,price:e.price,id:e.id}})),n=encodeURIComponent(JSON.stringify(r));e.navigateTo({url:"/pagesDemand/canteen/userorder?cart=".concat(n,"&shopid=").concat(t.shop_id)})}}};t.default=s}).call(this,r("df3c")["default"])},3995:function(e,t,r){"use strict";r.r(t);var n=r("398b"),a=r.n(n);for(var c in n)["default"].indexOf(c)<0&&function(e){r.d(t,e,(function(){return n[e]}))}(c);t["default"]=a.a},9532:function(e,t,r){},b82f:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){}));var n=function(){var e=this,t=e.$createElement,r=(e._self._c,e.orders.length),n=r?e.__map(e.orders,(function(t,r){var n=e.__get_orig(t),a=e.getOrderStatusText(t.status),c=e.getOrderTypeText(t.order_type),o=e.formatDate(t.created_at);return{$orig:n,m0:a,m1:c,m2:o}})):null;e._isMounted||(e.e0=function(t,r){var n=arguments[arguments.length-1].currentTarget.dataset,a=n.eventParams||n["event-params"];r=a.order;t.stopPropagation(),"-1"!==r.status&&e.orderDetails(r.id)}),e.$mp.data=Object.assign({},{$root:{g0:r,l0:n}})},a=[]},c187:function(e,t,r){"use strict";(function(e,t){var n=r("47a9");r("13b0");n(r("3240"));var a=n(r("e7fb"));e.__webpack_require_UNI_MP_PLUGIN__=r,t(a.default)}).call(this,r("3223")["default"],r("df3c")["createPage"])},e7fb:function(e,t,r){"use strict";r.r(t);var n=r("b82f"),a=r("3995");for(var c in a)["default"].indexOf(c)<0&&function(e){r.d(t,e,(function(){return a[e]}))}(c);r("f30d");var o=r("828b"),s=Object(o["a"])(a["default"],n["b"],n["c"],!1,null,"14cdddc7",null,!1,n["a"],void 0);t["default"]=s.exports},f30d:function(e,t,r){"use strict";var n=r("9532"),a=r.n(n);a.a}},[["c187","common/runtime","common/vendor"]]]);