<view class="data-v-b2ec9468"><title-bar vue-id="7ef36774-1" title="{{navigationBarTitle}}" class="data-v-b2ec9468" bind:__l="__l"></title-bar><view class="container data-v-b2ec9468"><view class="order-type-selection data-v-b2ec9468"><block wx:for="{{orderTypes}}" wx:for-item="type" wx:for-index="index" wx:key="index"><view class="order-type-wrapper data-v-b2ec9468"><view data-event-opts="{{[['tap',[['selectOrderType',['$0'],[[['orderTypes','',index,'value']]]]]]]}}" class="{{['order-type','data-v-b2ec9468',(selectedOrderType==type.value)?'order-type-active':'']}}" bindtap="__e"><text class="order-type-icon data-v-b2ec9468">{{type.icon}}</text><text class="data-v-b2ec9468">{{type.label}}</text></view><block wx:if="{{lastOrderType===type.value}}"><view class="last-selected-tip data-v-b2ec9468">上次选择</view></block></view></block></view><block wx:if="{{selectedOrderType==='1'||selectedOrderType==='2'}}"><view class="time-selection animate-fade-in data-v-b2ec9468"><view class="time-label data-v-b2ec9468"><text class="icon data-v-b2ec9468">🕒</text>预计用餐时间</view><picker mode="time" value="{{expectedTime}}" data-event-opts="{{[['change',[['onTimeChange',['$event']]]]]}}" bindchange="__e" class="data-v-b2ec9468"><view class="time-picker data-v-b2ec9468">{{expectedTime}}</view></picker></view></block><block wx:if="{{selectedOrderType==='3'}}"><view class="address-selection data-v-b2ec9468"><view class="address-label data-v-b2ec9468">外卖地址</view><view data-event-opts="{{[['tap',[['showAddressPopup',['$event']]]]]}}" class="address-input data-v-b2ec9468" bindtap="__e"><text class="data-v-b2ec9468">{{deliveryAddress.name+" - "+deliveryAddress.phone+" -\n\t\t\t\t\t"+deliveryAddress.address}}</text></view></view></block><block wx:if="{{$root.g0>0}}"><view class="product-list data-v-b2ec9468"><block wx:for="{{$root.l0}}" wx:for-item="item" wx:for-index="__i0__" wx:key="id"><view class="product-item data-v-b2ec9468"><view class="product-info data-v-b2ec9468"><view class="product-name data-v-b2ec9468">{{item.$orig.goods_name}}</view><view class="product-meta data-v-b2ec9468"><view class="product-quantity data-v-b2ec9468"><text class="quantity-label data-v-b2ec9468">数量:</text><text class="quantity-value data-v-b2ec9468">{{item.$orig.quantity}}</text></view><view class="price-info data-v-b2ec9468"><view class="unit-price data-v-b2ec9468"><text class="price-symbol data-v-b2ec9468">¥</text><text class="price-value data-v-b2ec9468">{{item.$orig.price}}</text><text class="price-unit data-v-b2ec9468">/份</text></view><view class="total-price data-v-b2ec9468"><text class="total-label data-v-b2ec9468">小计:</text><text class="price-symbol data-v-b2ec9468">¥</text><text class="total-value data-v-b2ec9468">{{item.g1}}</text></view></view></view></view></view></block></view></block><view class="order-summary data-v-b2ec9468"><view class="summary-item data-v-b2ec9468"><text class="data-v-b2ec9468">商品总价</text><text class="data-v-b2ec9468">{{"¥"+totalPrice}}</text></view><view class="summary-item data-v-b2ec9468"><text class="data-v-b2ec9468">配送费</text><text class="data-v-b2ec9468">{{"¥"+deliveryFee}}</text></view><view class="summary-item data-v-b2ec9468"><text class="data-v-b2ec9468">订单价</text><text class="data-v-b2ec9468">{{"¥"+totalOrderPrice}}</text></view></view><view class="order-button-box data-v-b2ec9468"><view data-event-opts="{{[['tap',[['submitOrder',['$event']]]]]}}" class="order-button data-v-b2ec9468" bindtap="__e">确认点餐</view></view><block wx:if="{{isAddressPopupVisible}}"><view class="address-popup data-v-b2ec9468"><view data-event-opts="{{[['tap',[['',['$event']]]]]}}" class="address-content data-v-b2ec9468" catchtap="__e"><view class="address-header data-v-b2ec9468"><text class="header-title data-v-b2ec9468">填写配送地址</text><text data-event-opts="{{[['tap',[['closeAddressPopup',['$event']]]]]}}" class="close-icon data-v-b2ec9468" bindtap="__e">×</text></view><view class="address-form data-v-b2ec9468"><view class="form-group data-v-b2ec9468"><text class="form-label required data-v-b2ec9468">姓名</text><input class="form-input data-v-b2ec9468" placeholder="请输入姓名" data-event-opts="{{[['blur',[['validateName',['$event']]]],['input',[['__set_model',['$0','name','$event',[]],['deliveryAddress']]]]]}}" value="{{deliveryAddress.name}}" bindblur="__e" bindinput="__e"/><block wx:if="{{errors.name}}"><text class="error-tip data-v-b2ec9468">{{errors.name}}</text></block></view><view class="form-group data-v-b2ec9468"><text class="form-label data-v-b2ec9468">性别</text><radio-group data-event-opts="{{[['change',[['onGenderChange',['$event']]]]]}}" class="gender-group data-v-b2ec9468" bindchange="__e"><block wx:for="{{genderOptions}}" wx:for-item="item" wx:for-index="__i1__" wx:key="value"><label class="radio-label data-v-b2ec9468"><radio value="{{item.value}}" checked="{{deliveryAddress.gender===item.value}}" color="#ff8000" class="data-v-b2ec9468"></radio><text class="data-v-b2ec9468">{{item.label}}</text></label></block></radio-group></view><view class="form-group data-v-b2ec9468"><text class="form-label required data-v-b2ec9468">电话</text><input class="form-input data-v-b2ec9468" placeholder="请输入手机号码" type="number" maxlength="11" data-event-opts="{{[['blur',[['validatePhone',['$event']]]],['input',[['__set_model',['$0','phone','$event',[]],['deliveryAddress']]]]]}}" value="{{deliveryAddress.phone}}" bindblur="__e" bindinput="__e"/><block wx:if="{{errors.phone}}"><text class="error-tip data-v-b2ec9468">{{errors.phone}}</text></block></view><view class="form-group data-v-b2ec9468"><text class="form-label required data-v-b2ec9468">详细地址</text><textarea class="form-textarea data-v-b2ec9468" placeholder="请输入详细地址" data-event-opts="{{[['blur',[['validateAddress',['$event']]]],['input',[['__set_model',['$0','address','$event',[]],['deliveryAddress']]]]]}}" value="{{deliveryAddress.address}}" bindblur="__e" bindinput="__e"></textarea><block wx:if="{{errors.address}}"><text class="error-tip data-v-b2ec9468">{{errors.address}}</text></block></view></view><view class="address-buttons data-v-b2ec9468"><button data-event-opts="{{[['tap',[['saveAddress',['$event']]]]]}}" class="save-button data-v-b2ec9468" bindtap="__e">保存地址</button><button data-event-opts="{{[['tap',[['closeAddressPopup',['$event']]]]]}}" class="cancel-button data-v-b2ec9468" bindtap="__e">取消</button></view></view></view></block></view></view>