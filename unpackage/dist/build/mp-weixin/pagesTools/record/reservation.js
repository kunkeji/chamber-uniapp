(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagesTools/record/reservation"],{"05fc":function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={data:function(){return{navigationBarTitle:"场地预约",siteinfo:{},dateTimeSlots:[],isConfirmModalVisible:!1,selectedDate:null,selectedTimeSlot:null,formData:{name:"",phone:""}}},onLoad:function(t){this.id=t.id||1},methods:{getTimeList:function(){var e=this;this.$util.request("main.Site.getTimeList",{id:this.id}).then((function(i){1===i.code?(e.dateTimeSlots=i.data.date_time_slots,e.siteinfo=i.data.siteinfo):t.showToast({icon:"error",title:"数据加载失败"})})).catch((function(){t.showToast({icon:"error",title:"请求失败"})}))},formatDate:function(t){var e=new Date(t);return e.toLocaleDateString("zh-CN",{month:"2-digit",day:"2-digit"})},formatTime:function(t){var e=new Date("1970-01-01T".concat(t,"Z")),i=String(e.getUTCHours()).padStart(2,"0"),n=String(e.getUTCMinutes()).padStart(2,"0");return"".concat(i,":").concat(n)},confirmBooking:function(t,e,i){this.selectedDate=t,this.selectedTimeSlot=e,this.timeSlotId=i,this.isConfirmModalVisible=!0},closeConfirmModal:function(){this.isConfirmModalVisible=!1},submitBooking:function(){var e=this,i={date:e.selectedDate,time_slot_id:e.timeSlotId,site_id:e.id};e.$util.request("main.Site.addRecord",i).then((function(i){1===i.code?(t.showToast({icon:"success",title:"预约成功",complete:function(){e.getTimeList()}}),e.closeConfirmModal()):t.showToast({icon:"error",title:"预约失败",complete:function(){e.getTimeList()}})})).catch((function(){t.showToast({icon:"error",title:"预约失败",complete:function(){e.getTimeList()}})}))}},mounted:function(){this.getTimeList()}};e.default=i}).call(this,i("df3c")["default"])},2172:function(t,e,i){"use strict";(function(t,e){var n=i("47a9");i("13b0");n(i("3240"));var o=n(i("36ac"));t.__webpack_require_UNI_MP_PLUGIN__=i,e(o.default)}).call(this,i("3223")["default"],i("df3c")["createPage"])},"36ac":function(t,e,i){"use strict";i.r(e);var n=i("6486"),o=i("79d8");for(var a in o)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(a);i("58fa");var r=i("828b"),c=Object(r["a"])(o["default"],n["b"],n["c"],!1,null,"157349e3",null,!1,n["a"],void 0);e["default"]=c.exports},"58fa":function(t,e,i){"use strict";var n=i("8f1f"),o=i.n(n);o.a},6486:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){}));var n=function(){var t=this,e=t.$createElement,i=(t._self._c,t.__map(t.dateTimeSlots,(function(e,i){var n=t.__get_orig(e),o=t.formatDate(e.date),a=t.__map(e.time_slots,(function(e,i){var n=t.__get_orig(e),o=t.formatTime(e.start_time),a=t.formatTime(e.end_time);return{$orig:n,m1:o,m2:a}}));return{$orig:n,m0:o,l0:a}})));t._isMounted||(t.e0=function(e,i,n){var o=arguments[arguments.length-1].currentTarget.dataset,a=o.eventParams||o["event-params"];i=a.timeSlot,n=a.dateSlot;i.can_book&&t.confirmBooking(n.date,i.name,i.time_slot_id)}),t.$mp.data=Object.assign({},{$root:{l1:i}})},o=[]},"79d8":function(t,e,i){"use strict";i.r(e);var n=i("05fc"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(a);e["default"]=o.a},"8f1f":function(t,e,i){}},[["2172","common/runtime","common/vendor"]]]);